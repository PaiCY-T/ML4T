---
epic: ML4T-Alpha
task_number: 1
title: Taiwan Market Regime Detection System
description: Implement intelligent market regime classification for Taiwan stock market with regime-aware strategy adjustments
status: in_progress
created: 2025-09-22T07:45:00Z
updated: 2025-09-22T07:45:00Z
assignee: null
depends_on: []
parallel: true
layer: 1
size: M
estimated_hours: 40
---

# Task 1: Taiwan Market Regime Detection System

## Overview

Develop a sophisticated regime detection system specifically calibrated for Taiwan stock market characteristics, including technology sector concentration, ±10% daily price limits, and unique market microstructure patterns.

## Objectives

- **Primary**: Classify market conditions into Bull/Bear/Crisis/Sideways regimes with >80% accuracy
- **Secondary**: Provide regime-specific strategy adjustment multipliers
- **Tertiary**: Enable real-time regime detection for live trading

## Technical Requirements

### Core Functionality

**Regime Classification Logic**
```python
Regimes:
- Bull: Strong momentum (>15% annual), moderate volatility (<18%)
- Bear: Negative momentum (<-10% annual), any volatility
- Crisis: Extreme volatility (>25%), fear-driven selling
- Sideways: Low momentum (-10% to 15%), moderate volatility
```

**Taiwan Market Calibration**
- **Price Limit Integration**: ±10% daily limits affect volatility calculations
- **Tech Sector Weighting**: TSMC/semiconductor influence on overall market
- **Retail Participation**: Higher volatility during retail-heavy periods
- **Policy Sensitivity**: Government announcements impact regime transitions

### Input Data Requirements

**Market Data**
- TAIEX daily prices (primary regime indicator)
- Individual stock prices (cross-validation)
- Volume data (confirmation signals)
- VIX-equivalent volatility measures

**Calculation Parameters**
- **Lookback Window**: 60 trading days (3 months)
- **Update Frequency**: Daily after market close
- **Confidence Threshold**: >70% for regime confirmation
- **Transition Smoothing**: 5-day moving average to prevent whipsaw

### Output Specifications

**Regime Detection Output**
```python
def detect_regime(price_data) -> tuple:
    return (regime_name: str, confidence: float, adjustment_multiplier: float)

# Example outputs:
("bull", 0.85, 1.2)      # High confidence bull market, amplify signals 20%
("crisis", 0.92, 0.3)    # High confidence crisis, reduce exposure 70%
("sideways", 0.68, 0.9)  # Moderate confidence sideways, slight reduction
```

**Strategy Adjustment Logic**
- **Bull Market**: Amplify momentum signals 10-30%, increase position sizes
- **Bear Market**: Focus on defensive positions, reduce overall exposure
- **Crisis**: Minimal exposure (20-40%), only highest conviction signals
- **Sideways**: Balanced approach with mean reversion bias

## Implementation Plan

### Phase 1: Core Algorithm Development (Week 1)

**Day 1-2: Base Regime Detection**
- Implement momentum and volatility calculations
- Define Taiwan-specific regime thresholds
- Basic regime classification logic

**Day 3-4: Taiwan Market Calibration**
- Integrate ±10% daily limit effects
- Add tech sector concentration adjustments
- Policy announcement reaction detection

**Day 5: Initial Testing**
- Historical regime classification validation
- Compare against known market periods (2008, 2020 crashes, tech booms)

### Phase 2: Optimization & Validation (Week 2)

**Day 6-7: Accuracy Improvement**
- Optimize threshold parameters using historical data
- Implement regime transition smoothing
- Add confidence scoring mechanism

**Day 8-9: Strategy Integration**
- Develop regime adjustment multipliers
- Test strategy performance across different regimes
- Validate regime-aware signal generation

**Day 10: Final Validation**
- Comprehensive historical testing
- Edge case handling (market holidays, extreme events)
- Performance benchmarking vs static approach

## Deliverables

### Code Components

**Core Classes**
```python
# /src/regime/taiwan_regime_detector.py
class TaiwanMarketRegimeDetector:
    def __init__(self, lookback_days=60)
    def detect_regime(self, price_data, volume_data=None)
    def get_regime_adjustment(self, regime, base_signal)
    def get_regime_history(self, start_date, end_date)

# /src/regime/regime_calibrator.py
class RegimeCalibrator:
    def optimize_thresholds(self, historical_data, target_accuracy=0.8)
    def validate_regime_accuracy(self, regime_predictions, actual_events)
    def generate_performance_report(self)
```

**Utility Functions**
```python
# /src/regime/regime_utils.py
def calculate_market_momentum(prices, window=20)
def calculate_regime_volatility(prices, window=20)
def detect_policy_announcements(news_data=None)  # Future enhancement
def validate_regime_transitions(regime_series)
```

### Configuration Files
```yaml
# /config/regime_detection_config.yml
regime_thresholds:
  bull_momentum_min: 0.15      # 15% annual momentum
  bear_momentum_max: -0.10     # -10% annual momentum
  crisis_volatility_min: 0.25  # 25% annual volatility
  sideways_momentum_range: [-0.10, 0.15]

taiwan_adjustments:
  daily_limit_factor: 0.10     # ±10% daily limits
  tech_sector_weight: 0.65     # Tech sector market cap weight
  retail_volume_threshold: 1.5  # Above-normal retail activity

strategy_multipliers:
  bull: [1.1, 1.3]     # Range of signal amplification
  bear: [0.2, 0.5]     # Range of signal reduction
  crisis: [0.1, 0.4]   # Minimal exposure range
  sideways: [0.8, 1.0] # Neutral range
```

### Testing & Validation

**Test Cases**
```python
# /tests/regime/test_taiwan_regime_detector.py
class TestTaiwanRegimeDetector:
    def test_known_bull_periods(self):
        # Test 2014-2017 tech boom period

    def test_known_bear_periods(self):
        # Test 2008 financial crisis, 2018 trade war

    def test_crisis_detection(self):
        # Test COVID March 2020 crash

    def test_regime_transitions(self):
        # Test smooth transitions between regimes

    def test_taiwan_specific_features(self):
        # Test daily limit integration, tech sector effects
```

**Performance Benchmarks**
- **Accuracy Target**: >80% regime classification vs manual expert assessment
- **Transition Detection**: <5-day lag for major regime changes
- **False Positive Rate**: <15% for regime change signals
- **Strategy Improvement**: >10% better Sharpe ratio vs static approach

## Success Criteria

### Technical Validation
- ✅ Regime detection accuracy >80% on historical data (2014-2024)
- ✅ Crisis periods correctly identified (COVID March 2020, trade war 2018)
- ✅ Bull markets correctly identified (2014-2017 tech boom, 2020-2021 recovery)
- ✅ Regime transitions occur within 5-day window of actual market shifts

### Strategy Performance Validation
- ✅ Regime-aware strategy outperforms static approach by >1% annually
- ✅ Reduced drawdowns during crisis periods vs baseline
- ✅ Enhanced returns during bull periods vs baseline
- ✅ Stable performance during sideways markets

### Code Quality
- ✅ >90% test coverage for all regime detection components
- ✅ Historical backtest reproduces within 0.1% accuracy
- ✅ Real-time regime detection completes within 30 seconds
- ✅ Modular design allows easy threshold adjustment and calibration

## Risk Management

### Technical Risks
- **Overfitting Risk**: Regime thresholds optimized on historical data may not generalize
  - *Mitigation*: Out-of-sample validation, conservative threshold selection
- **Market Structure Change**: Taiwan market evolution may invalidate regime patterns
  - *Mitigation*: Regular recalibration, adaptive threshold updates

### Implementation Risks
- **Data Quality**: Inaccurate or missing data affects regime classification
  - *Mitigation*: Data validation checks, fallback regime detection methods
- **Performance**: Regime detection may be too slow for real-time usage
  - *Mitigation*: Optimization focus, pre-calculated regime indicators

## Integration Points

### Upstream Dependencies
- **Taiwan Market Data**: TAIEX prices, volume data (FinLab API)
- **ML4T Base Framework**: Existing data processing pipeline

### Downstream Dependencies
- **Task 2**: Dynamic position sizing will use regime adjustments
- **Task 4**: Multi-regime strategy logic depends on regime classification
- **Task 6**: Historical validation requires regime performance analysis

## Taiwan Market Context

### Historical Regime Examples
- **Bull 2014-2017**: TSMC-led semiconductor boom, consistent momentum
- **Bear 2018-2019**: US-China trade war impact, tech sector decline
- **Crisis Mar 2020**: COVID-19 crash, extreme volatility
- **Recovery 2020-2021**: Work-from-home tech demand surge
- **Sideways 2022-2023**: Interest rate concerns, mixed signals

### Market Structure Considerations
- **Technology Concentration**: 65%+ market cap in tech sector
- **Daily Price Limits**: ±10% maximum daily moves
- **Retail Participation**: High retail investor activity vs institutional
- **Policy Sensitivity**: Government announcements significantly impact markets
- **Export Dependency**: Global economic conditions affect Taiwan markets

## Future Enhancements

### Advanced Features (Post-MVP)
- **Sentiment Integration**: Social media, news sentiment for regime confirmation
- **Policy Detection**: Government announcement impact modeling
- **Sector Regime Detection**: Individual sector regime classification
- **International Correlation**: US/China market regime influence

### Machine Learning Integration
- **Regime Prediction**: ML models to predict regime transitions
- **Feature Engineering**: Additional technical and fundamental regime indicators
- **Ensemble Methods**: Multiple regime detection approaches combined
- **Real-time Learning**: Adaptive thresholds based on recent performance